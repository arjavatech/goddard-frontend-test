<!DOCTYPE html>
<html>

<head>
    <title>Active Form</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="image/gs_logo_tab.png" type="image/png">
    <link rel="stylesheet" href="css/navbar_signout_style.css">
    <link rel="stylesheet" href="css/admin_dashboard.css">
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.922.0.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script> -->

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.js"></script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css">
    <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.13/js/bootstrap-multiselect.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-multiselect/0.9.13/css/bootstrap-multiselect.css">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
</head>
<style>
    html
    {
        font-size: medium;
    }
</style>

<body>
    <!-- Navigation Bar -->
    <nav class="navbar_bg">
        <div class="text-center">
            <img src="image/gs_logo_branch.png" alt="gs_logo_branch" type="image/png" width="476px" height="112px">
        </div>
        <div id="btn-signout" class="btn signout"><i class="fa-solid fa-arrow-right-from-bracket"></i>&nbsp;<b>Sign
                Out</b></div>
    </nav>
    <!-- Navigation Bar End -->
    <!-- Admin dashboard -->
    <div class="container">
        <h2 class="admin_dashboard_title h2 pt-4 text-center">Active Form Details</h2>       
        <div class="container">
            <div class="row m-5">
                <form id="multiselectdata">
                    <div class="col-sm-12">
                        <div class="form-group">
                            <strong class="text-center">Active Form Details:</strong>    
                            <!-- <strong>Select Language:</strong> -->
                            <select id="form_name" name="form_name" class="form-control" multiple="multiple"></select>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button id="submitButton" type="button" class="btn btn-primary btn-bg">Submit</button>
                    </div>
                </form>
                
            </div>
        </div>               
    </div>
   
    <!-- Admin dashboard End -->
    <script>
        $(document).ready(function() {
            // Initialize the Bootstrap Multiselect plugin
            $('#form_name').multiselect({
                includeSelectAllOption: true,
            });
    
            $('#submitButton').on('click', function(e) {
                e.preventDefault();
                submitAction();
            });
    
            // Call your data population function after initialization
            fetchDataAndPopulateDropdown();
        });
    
        function fetchDataAndPopulateDropdown() {
                    console.log('Fetching data and populating dropdown...');
                    $.ajax({
                        url: 'https://y4jyv8n3cj.execute-api.us-west-2.amazonaws.com/goddard_test/goddard_all_form/all/forms?status=true',
                        type: 'GET',
                        success: function(response) {
                            console.log(response);
                            let responsevalue = Object.values(response);
                            console.log(responsevalue);
                            let optionsData = '';
                            let selectElement = document.querySelector('#form_name');
                            selectElement.innerHTML = ''; // Clear existing options
    
                            for (let i = 0; i < responsevalue.length; i++) {
                                optionsData += '<option value="' + responsevalue[i].form_name + '">' + responsevalue[i].form_name + '</option>';
                            }
    
                            selectElement.innerHTML = optionsData;
    
                            // Update the Multiselect plugin to reflect the changes
                            $('#form_name').multiselect('rebuild');
                        }
                    });
                }
    
     
    
        function submitAction() {
        const form = document.getElementById("multiselectdata");
        const selectedValues = $('#form_name').val(); // Get the selected values as an array
        console.log(selectedValues);
        // Set the selected values in the hidden input field
        const data =selectedValues.join(','); // Join the array into a comma-separated string
        const formData = new FormData(form);
        const obj = Object.fromEntries(formData);
        obj.form_name = data;
        console.log(obj);
    
        $.ajax({
            url: "https://y4jyv8n3cj.execute-api.us-west-2.amazonaws.com/goddard_test/active_form_data/add",
            type: "POST",
            contentType: "application/json",
            data: JSON.stringify(obj),
            success: function(response) {
                console.log(response);
            },
            error: function(xhr, status, error) {
                console.log(error);
            }
        });
    }
    
        </script>
   
</body>

</html>
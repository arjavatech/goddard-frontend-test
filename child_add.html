<!DOCTYPE html>
<html>
    <head>
        <title>Welcome-Dashboard</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link rel="shortcut icon" href="image/gs_logo_tab.png" type="image/png">
        <link rel="stylesheet" href="css/form_style.css">
        <link rel="stylesheet" href="css/navbar_signout_style.css">
        <link rel="stylesheet" href="css/child_add.css">
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.2.0/css/all.min.css" />
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
        <script type="module" src='js/welcomeScreen.js'></script>
        <script type="module" src='js/timeout.js'></script>
        <!-- <script type="module" src='/js/script.js'></script> -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
        <style>
            .accordion-button:not(.collapsed)::after {
                background-image: url('image/down_white.png');
                transform: rotate(-180deg);
            }
        </style>
    </head>
    <body>
        <!-- Navigation Bar -->
        <nav class="navbar_bg">
            <div class="text-center">
                <img src="image/gs_logo_branch.png" alt="gs_logo_branch" type="image/png" width="476px" height="112px">
            </div>
            <div id="btn-signout" class="btn signout"><i class="fa-solid fa-arrow-right-from-bracket"></i>&nbsp;<b>Sign Out</b></div>
        </nav>
        <!-- Navigation Bar End -->
        <!-- Welcome Screen -->
        <div class="p-3">
            <h2 class="parent_dashboard_title h2 pt-4 text-center">Parent Dashboard</h2>
            <!-- Welcome Text -->
            <h4 class="h4 pt-2 text-center" id="welcomeText" name="welcomeText"></h4>
            <div class="row" id="additionalHtmlContainer">
                <!-- Dynamic Child Cards -->
                <div id="dynamicChildCards" class="row">
                    <!--        <div class="col-2 m-3 mt-4">-->
                    <!--            <a href="parent_dashboard.html" class="text-decoration-none">-->
                    <!--                <div class="card dashboard_card_style1">-->
                    <!--                    <div class="card-body pt-4">-->
                    <!--                        <h5 id="childname" class="text-center dashboard_card_text pt-3 h4"></h5>-->
                    <!--                    </div>-->
                    <!--                </div>-->
                    <!--            </a>-->
                    <!--        </div>-->
                </div>
                <!-- Add Child -->
                <div class="col-2 m-3 mt-4" onclick="divShow()" id="showDiv">
                    <!-- <a href="parent/child_basic_details.html" class="text-decoration-none"> -->
                        <div class="card dashboard_card_style">
                            <div class="card-body pt-4">
                                <h5 class="card-title text-center dashboard_card_icon">
                                    <!-- Add Child Icon -->
                                    <svg xmlns="http://www.w3.org/2000/svg" width="60"
                                        height="60" fill="currentColor"
                                        class="bi bi-plus-circle-fill"
                                        viewBox="0 0 17 17">
                                        <path
                                                d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0zM8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3v-3z"/>
                                    </svg>
                                </h5>
                                <h5 class="text-center dashboard_card_icon pt-3 h4">Add Child</h5>
                            </div>
                        </div>
                    <!-- </a> -->
                </div>
                <!-- Add Child End -->
            </div>
        </div>
        <!-- Welcome Screen End -->
        <div class="row m-3" style="display: none;" id="addChildDiv">
            <!--Child and Family History Form-->
            <div id="child_basic_form"><br>
                <div class="card_center">
                    <div class="card child_basic_card">
                        <h2 class="text-center card_title p-4">Child Basic Information</h2><br>
                        <div class="container" id="avf_form">
                            <section class="wizard-section">
                                <div class="row no-gutters">
                                    <div class="col-lg-12 col-md-12">
                                        <div class="form-wizard">
                                            <form id="childBasicForm">
                                                <fieldset class="wizard-fieldset">
                                                    <div class="container">
                                                        <div class="panel panel-info">
                                                            <!-- Admission form heading -->
                                                            <!-- <div class="panel-heading">
                                                                <h3 class="panel-title text-center"><b>./forms/authorization for Recurring Billing via ACH</b></h3>
                                                            </div> -->
                                                            <!-- Admission form body -->
                                                            <div class="panel-body">
                                                                <div class="row">
                                                                    <div class="col-sm m-3">
                                                                        <div class="form-group">
                                                                            <label for="child_full_name" class="form-label"><b>Name of Children
                                                                                <!-- <span style="color:#ff0000;">*</span> -->
                                                                            </b></label><br>
                                                                            <input name="child_full_name" type="text" maxlength="20" 
                                                                            class="form-control wizard-required" id="child_full_name">
                                                                            <div class="wizard-form-error"></div>
                                                                        </div>
                                                                    </div>
                                                                </div> 
                                                                <div class="row">
                                                                    <div class="col-sm m-3">
                                                                        <div class="form-group"> 
                                                                            <label for="dob" class="form-label"><b>Date Of Birth</b></label>
                                                                            <input type="date" class="form-control wizard-required" id="dob"
                                                                                name="dob"/>
                                                                                <div class="wizard-form-error"></div>
                                                                        </div>
                                                                    </div> 
                                                                    
                                                                </div>         
                                                            </div>
                                                            
                                                            <div class="panel-footer">
                                                                <div class="form-group clearfix m-3">
                                                                    <div class="text-center">
                                                                        
                                                                            <button class="cancel-btn">Cancel</button>
                                                                            <button href="javascript:;" class="submit-btn" id="submit_button">Submit</button>
                                                                        
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>      
                                                    </div>
                                                </fieldset>               
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </section> 
                        </div>
                    </div>
                </div> 
            </div>
        </div>
        <script>
            $(document).ready(function () {
          
                $("#showDiv").on("click", function (e) {
                    e.preventDefault(); // Prevent the default form submission
                    divShow();
                });
                $("#submit_button").on("click", function (e) {
                    e.preventDefault(); // Prevent the default form submission
                    submitForm();
                });
            });
            function divShow(){
                let addChildDiv = document.getElementById('addChildDiv');
                if(addChildDiv){
                    addChildDiv.style.display = 'block';
                }else{
                    addChildDiv.style.display = 'none';
                }
            }
            // Function to submit the form data
            function submitForm() {
                const form = document.getElementById("childBasicForm");
                const formData = new FormData(form);
                const obj = Object.fromEntries(formData);
                const logged_in_email = localStorage.getItem('logged_in_email');
                obj.primary_parent_email = logged_in_email;
                obj.on_process = true;
                localStorage.setItem('child_full_name', obj.child_full_name);
                localStorage.setItem('dob', obj.dob);
                console.log(obj);
                $.ajax({
                    url: "https://y4jyv8n3cj.execute-api.us-west-2.amazonaws.com/goddard_test/admission_child_personal/add",
                    type: "POST",
                    contentType: "application/json",
                    data: JSON.stringify(obj),
                    success: function (response) {
                        alert(response.message);
                        console.log(response.message);
                        window.location.reload();
                    },
                    error: function (xhr, status, error) {
                        alert("failed to submit admission form");
                    }
                });
            }
        </script>
    </body>
</html>